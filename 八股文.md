# 八股文

## 浏览器介绍

### 浏览器组成

分两部分：

- 渲染引擎 （浏览器内核）
- JS引擎

### 渲染引擎

用来解析HTML和CSS；

渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息

**渲染引擎**是浏览器**兼容性问题** 出现的根本原因

Rendering Engine 

作用：读取网页内容，计算网页的显示方式，显示在页面

### JS引擎

“JS解释器”

解析网页中js代码，对其处理后再运行

浏览器本身不会执行js代码。

js引擎执行代码会逐行解释每一句源码---转换为机器语言，然后由计算机去执行

### 浏览器工作原理



页面解析渲染：

![工作原理](https://pic3.zhimg.com/80/v2-f7473c255fd30b53cb32e08da905b2fe_720w.jpg)



HTML解释器，解析HTML，生成DOM树；

CSS解释器，解析样式表，生成样式规则，CSSOM树；

在解析步骤中创建的 CSSOM 树和 DOM 树组合成一个 Render 树，

Layout：Render 树用于计算每个可见元素的布局属性，位置，大小。

Painting：然后将其绘制到屏幕上。

### 关于CSS和JS阻塞解析

- 遇到 JS 链接时，会调用请求，异步获取资源。

  JS可能会修改DOM树和CSSOM树，造成回流和重绘，由此阻塞DOM树的构建

- CSS不会阻塞解析过程；

### 处理script和css style的顺序

- 运行到script时，文档解析会暂停，知道脚本执行完毕 

  设置defer属性，会在文档解析后执行脚本

- 样式表不会改变DOM树，所以不会停止文档解析

### 布局或回流或重排

重新计算位置和大小，这些值，称为布局或回流

**任何会改变元素几何信息(元素的位置和尺寸大小)的操作，都会触发重排**，下面列一些栗子：

1. 添加或者删除可见的DOM元素；
2. 元素尺寸改变——边距、填充、边框、宽度和高度
3. 内容变化，比如用户在input框中输入文字
4. 浏览器窗口尺寸改变——resize事件发生时
5. 计算 offsetWidth 和 offsetHeight 属性
6. 设置 style 属性的值

1. | 常见引起重排属性和方法  |                          |                    |            |      |
   | ----------------------- | ------------------------ | ------------------ | ---------- | ---- |
   | width                   | height                   | margin             | padding    |      |
   | display                 | border                   | position           | overflow   |      |
   | clientWidth             | clientHeight             | clientTop          | clientLeft |      |
   | offsetWudth             | offsetHeight             | offsetTop          | offsetLeft |      |
   | scrollWidth             | scrollHeight             | scrollTop          | scrollLeft |      |
   | scrollIntoView()        | scrollTo()               | getComputedStyle() |            |      |
   | getBoundingClientRect() | scrollIntoViewIfNeeded() |                    |            |      |

#### 浏览器渲染队列机制

当我们修改了元素的几何属性，导致浏览器触发重排或重绘时。它会把该操作放进渲染队列，等到队列中的操作到了**一定的数量或者到了一定的时间间隔**时，浏览器就会批量执行这些操作。

### 重绘

外观改变，比如填充颜色

**重绘不一定出现重排，重排一定会出现重绘**







